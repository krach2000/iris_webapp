<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">

    <!-- Bootstrap CSS -->
    <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet">
    <title>WebApp</title>
</head>
<body>


<!---NAVBAR--->
<div class="container-fluid">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">WebApp</a>
            <button aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"
                    class="navbar-toggler"
                    data-target="#navbarNav" data-toggle="collapse" type="button">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item active">
                        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Classifer</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>


<!--Form-->
<div class="container">
    <h1>Variable Input</h1>
    <form action="/" enctype="multipart/form-data" id="form" method="post">
        <label for="x_var">Please choose X-variable:</label>
        <select id="x_var" name="x_var">
            <option value="0">Sepal Length</option>
            <option value="1">Sepal Width</option>
            <option value="2">Petal Length</option>
            <option value="3">Petal Width</option>
        </select>
        <br>
        <label for="y_var">Please choose Y-variable:</label>
        <select id="y_var" name="y_var">
            <option value="0">Sepal Length</option>
            <option value="1">Sepal Width</option>
            <option value="2">Petal Length</option>
            <option value="3">Petal Width</option>
        </select>
        <br>
        <input id="cluster_num" max="5" min="1" name="cluster_num" step="1" type="range" value="3">
    </form>
</div>

<!--plot image-->
{% if graph != None %}
<div class="container">
    <img alt="Chart" src="data:image/png;base64,{{graph}}">
</div>
{% endif %}


<div class="container">
    <div class="chart" id="chart">
    </div>
</div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2"
        src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</body>

<script>
  var cluster_num = document.getElementById('cluster_num');
  var x_var = document.getElementById('x_var');
  var y_var = document.getElementById('y_var');

    form.onchange = function() {
        $.post({
                url: '/cluster_num',
                contentType: "application/json",
                data: JSON.stringify({"cluster_num": cluster_num.value, "x_var": x_var.value, "y_var": y_var.value})
        }).done(function(data) {
                var num = 0;
                console.log(data)
                var plt_data = [];
                var i;
                for (i=0; i < cluster_num.value; i++) {
                    plt_data.push({x: data["XT" + i.toString()], y: data["YT" + i.toString()], mode: 'markers', type:'scatter', marker:{size:12}});

                }

                plt_data.push({x: data["XCC"], y: data["YCC"], mode: 'markers', type:'scatter', marker:{size:13, symbol: 'x'}});

                x_label = x_var.options[x_var.selectedIndex].text;
                y_label = y_var.options[y_var.selectedIndex].text;
                var layout = {xaxis: {title: {text: x_label}},yaxis: {title: {text: y_label}},showlegend: false};
                Plotly.newPlot('chart',plt_data, layout);
        });
    }



</script>

</html>